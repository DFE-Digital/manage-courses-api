language: csharp
dist: trusty
sudo: required
mono: none
dotnet: 2.0.0
env:
  global:
  - secure: SWBz9hCvvAuDdyPtBLLw54t6XYzgs9ecjilNhjWRt/Az2L4d3xpZXIrxHtXkAFi1O+WRoYVcDfd6YO0eQHqI2FYlXO/w44SDhc/lFdVhsJpstpYaXk/bwQ7FuwwbWseAuRIhClemM5v8/UMcGdcy8YKeobv7Gf/brXPkCFN+2bA8oKacmS5g7XnLGnEbVfjXBzaQeHdd17k05+PNLKLg6vVbVNT8RVaGkDiBKS3hiwuXZzZ/z0aeuhg7Vw+u+e34GCoUWwCfftdDrmXRlnPjWuPRW+DDVEU8WmJFlbwzOnzswIPUfOCb9G5IjIt2+5oF4NMm4h0u74Jl8TpB1KQWgsd6zSxeBZrTVF2BqgbSEs3TSFY6cAoA6VB2Z9fb6Mqh+ukBVOpME+N+EjC5bI639xpIF4vz1/XiiLfsxRrzeidXkCnS5pT/nlOt3AShGp1J8eaKW+Ikf/11MiDneaa04JK2Pdp+RO4upjtXxnZY6sMrSlo4U3OegR5FxzCp9SAXgWv4zRyQVneZ1I9o30wphObfV5nGaFzaDkfmH78TC/f9jbclRR1J8raH+tfHwvQVBPjxgre6lw8mb2SSLaNnumsSxQyH3uO8Kv/s9EjnhZE0hF0f9luMGMpfVxgrtz2a7BHfADlyLxRZjA6oFDpEdS8lF03ml4gSgHRCmusaePs=
  - MANAGE_COURSES_POSTGRESQL_SERVICE_HOST=127.0.0.1
  - MANAGE_COURSES_POSTGRESQL_SERVICE_PORT=5432
  - PG_USERNAME=postgres
  - PG_PASSWORD=
  - PG_DATABASE=travis_ci_test
  - auth__oidc__userinfo_endpoint=https://signin-test-oidc-as.azurewebsites.net/me
  - credentials__dfesignin__host=signin-test-oidc-as.azurewebsites.net
  - credentials__dfesignin__redirect_host=localhost:44364
  - api__key=Q2FuIHQzY2ggbGVhZCBjb2RlIGJlIHNtZWxsIWVyIHRoQG4gbWluZT9GcmkgSnVsIDIwIDIwMTggMTM6MjU6NDMgR01UKzAxMDAgKEJyaXRpc2ggU3VtbWVyIFRpbWUp
  - secure: DbducP/zPgby9q20KHGcZ9yPYBlFxWgpgFq0ZMiBfMZO++sOBbTpFslLXJwZ5zpvpDlQZu/+lJt4YzSRKMj49TCpkj+BX5sT1cTZgqqHhkFQxIgeEBWmVsinu4ihnMWa6ljjccr+og3Idd77e61tfeikaBtlDlzPuKUWXxlx89Ec2m3vvuX4vmm+9ZdvB3tRHjrnHlbGcvGu3JyumkC3n31QFA4hTTWuRAzF1IOH/i8SvxiEWheofAy2aXTLC0fgFxnN51FQVeDIxGGVdY/kY65sbhURD1Af6aO3zC73MVv9E4JNPuPjZROWAsLDzJRQvtdLAYQjUzKYpMD+ggLsh4HhdawKGeK2wEkbWd28mI0s462B7pEdnmRwcOdOMbgrm44DqGZBsXmW2nhUboxWO+hG5zX9hfq1chYHmVAHs8ZZBLw7xM9xotAufqbezcS/gh+HEUzZ6Vi7b9eIGaLScltzvddLG7pFqBgycQ8rxU3czapBhSetNZ3emDH7tP1uxkBR7uwuxTOg+VegHEFt/VWVsmPG6o9/y0nWKE7HG3wpX42rCGVP4HErtpb7b+YTlfhzXxVl2ROp1XR7sVWuJawBdyC4Jf4JZzQ4yg5V6RTYtkisaB8/DSZl1g9erM5Cv0QmZgLPAH9oiQsOTUvV/woFst5orCX8nMfF3hV8Ceg=
  - secure: aqSLpftaQtni7UDKqrqsPlOAB75Ilnd2ROXnQ983C/Rtx/fNYnytQAvQ/iIDqETeDnpQnI731upKqedOIIe40xYc/M4u7xhm2rPAaAllrVAOEGGmz7ryVMCNpFTt5iNHFRpfHlembO8hVURQg2Dx4OSTDblY6ABnlEIMk4zBGIcr17Om6plnH5beXcxaeKtGgYbFOO4CvuAFW4lmJelmNSQ9j07dfbGveGs6YPzSZuOickhgUMn8MzGuAw97nONtZelsQTSl7Qt93eeZ5lnXl0hAZHto6sNGDPoHX6HKlH6Tj18jSWqfPZXuIKxz0XRmwUmoDFEog2rud48ZZBIi9OMOa+iIqKngeK4wedTTDVdGQaj9zf0aoB8MLgm1IAtus7p8et9yMNUe/bs4GLwh0SKkEOmHyj2Gn6TxzqlRbFp9wv8p1zUvrDjHUDX1tFko/FFqz35/qOtVeI9Q4t/6ne0p98RGNpMO4354c5XLrkcTG4KzHNsRjTbC6S2ABtS2Ya/r1RFO21R+4sD18WO5bVMUd2Dbi4ASRfpgTrLQUHXoIpgPQRSkyuWT4siFb6r9y5maZ5ZLbm3UV3qfSpQzs9CAhU8RyyIv9w6L/ruLCviuREuhu9GrPdyATqsNMDipiwH9oZchxNg5cBBQlwxVJ38cSzmfzAXYpEvoJJltI88=
  - secure: LBhATH1W+keLCumwz6oIyPAQUzH02Xw0Gj2hzZkUtEIPkBkmUNyLFkhnPTrWfovqZreCYL8Id22o9JyNUjzSqgvnnBoaYc1JhKtCCXRAlXym7ORlLpnQiLaTD7XDz4bYjJPbvpDVztNdrr8wxgwoiiFijsKJU3CY3FHWYP72DqC0stiPwNpsf2ReiXieN4DIVA64d3xtLdzMIy5HTXXCxdk50EUhk++fpCUbAQm7kKOHGIWAk0ayJUWo6a3ivykFO3ROffoHd8T4pCYlI/xhCEHGEiFTzZNwTbUIq/xAQGEkx9+Bbot/mEu4AK6Ow8C1Ynm6ezO27E3P/TDkoLODilIYx+h9Rm6gJxr3PgwixXb8HAkpLUb6QRZ8oBp1CTC9m+V3DFvYgFiGfReExVNKOjGd20EhHQ3WmArindXxN2Pm3qocf/RRclfV0NAg9LE4QzWjfK9YuNfudA2ekcJD7cgA3TaxnMwIc5aiP6TMMsvEBr4qXKHej9fb13lLM2Z1JLJeW6BDK/Fq5nuSSN9Tw8b7GH9LC1iaXFnNV8AoRM3ZLXZ2DcCRZjFsBU/IcYe+mWZCdOP33PMlk1tQngqzG1gDFULvijJQjXF7m2Soeqy6rn5LzTky2IULpbXALFvk5CA1fdwEzvoMPIUJqbIrO+Xgpkx4DqzaKJKmPqvzUl8=
  - secure: RJx4jCH3jcdhz8irbF+WaFr8HsVYcUVXuR1L0ga0iYotY3C/YAwckgrvoAxCdDFh3KdZ8rrpZ1S0o6IhgPwnJRG81UyfyTAc53izbrbkxZPCQ/1F5osk+6Hhs58tPPuxD9qtooHSYd5yyZ6mHmvqDZv8NKhL60t31y7ysNOYysHnNO82/vSFuuRakjIFgt1jqDE33670bJ+6Ox9ij8DWP5Wy86rvzWBjQVz5/P2qtgp3OawMlNZKnDADiYeLBbZgSxgcdoPIXyOSlkRkeiIAHIWXQUU23OZVr3AAlN+zhnnxwJGisQ8+Ymw+qGaK0jFQDJC58UZOZ/q1BOHeUcVthqHiwaJ8LJW1SiCLIAM1d8OLTp871MSlEIlKHEnMwmuCg+sugjGBpu8wa1G78ZvsQhfXv0KjaR3ZAwemN/dSjB3zXs0x0ER2mCft11/nQo91V7u3ZTQlxeDvz/IzAi3IlS8CQsy5c/d4Aq3XcSEcQ3FINwnxa9q0NI/9xrn8UzFAgFmE7mYzTSRql2SK1A2qDguodMIhh0jKqzTk2w/87RE892pYDcmp4nZ2Ql0EMs3dplJwGE60wzvKbjRaimbPfIG9sXOXjomfXAwLM/BxblZT5U3fpellZqCad6GQy+MRS8hmPQqNkJGipDNrWO6hfP1CjnUaoUusmE1tIOfqMuE=
  - secure: GyVFEnmc/2EAs634kBTer/KSADGM01ivCMJJxep42ZgUizNFd1T3urXNZp44HNR1NxLPxED3A5JDeAPOwXIYeOhHpFSOSQuZb1W3+KBfVTNwfKsa7uwvY87oGKO8V/FKTyS60l6Z5odTlUJI5sMC0ZkAge0tCGS6uwSMoH7SElAIyVPGHaYCxU4C6KXLnikhwjnKiYQdXveAgHp3f3gyknG3wVc0+/CKO88W2gq9dbetO/cKoV6WT9VvT2HfWzdF/qrwHscnHu6aC/BjmIYDSdvkC7aXCMCflCpWBX2Mx+uIDPprBhmBQtWhH2jEi07qgD+E1nmEvm3pZ534JbA3D9I5MUN8upxWJ44q62OppfpoW2jq/zB7+tO8JQx7rOb6Ms07YI6xC766jfuiwdf5TRa3ZWQCAZS6UVq0bQq/iqj8FRJZlF+ecr0PQkG4vqwWj8E9ykW6ZGpzt5mAPU6xA/74EsH+poUu6/g6/vc0l1oBfUaLOO5m9imvnfX02o9gMxgxvyP3cUriutNhf8DXj+N5WS15BXBp0ajsaspJnH78Mae0qnUvsI0Vq9W657rc2RDAfDTdoUbISEdYvyI3K248mS2wZ6c58hXucXkbkko92XMVUjd8AS83xKHUz3Lx7p1s3QI8QTG21oCtgSbMPbo66NA53sSpkXvXF2iUy4E=
  - secure: Kbs8hBsqPgHvrYUfqdf4XgCRgEasWfFd63tqB/aM/BIti/sEEoDJigjjTlrGFTb46prrRRv0lv8amNPQzY2CZtCqlGI2ZoZtdpEJhbR53Lu3NBbSIoMTe2BvFEU9s31IwzXIa/7hnIpdLWaDFgR5qeeCD5X4B8oEAIeRY5RgyzB0Zna2j/PRwy/0YcRjSWhI1rSYtmJaN+UmsDqvWM5qiL7Ax9Y4ybfz74I8IfOrPbieMC5qpu40go/iPxnaaq3noCboUKMtI9EilOkicHpxzSXpDlPU2bSjOKl3UC4GzvDnN/gue0A16LA0RJMXsV2YuVZln3ZXH7WyW2VeNZxOiPcfYeuYO93Dd3hel071OcHvyzaRaGB3h2Z6T9wryc+Gdkhntb2PtFLacwWZOy6mLZNmlQiCD2t4pYmMbl+YjZ1TcvL8Y4h53Ve16xfs6yb9qwFTN6bJvdQ2kQZb7TuEbvMMwjPOwyRewJZwyQ5SbDtpd7QmD8kBnhzvpjjm70kdEUFsQZlX0Gefe/0DOb7HnPXwi/nYvhVuPHaGitIRAPvubuXXEtJlWagl4PVIN8p+GVrZ0CL+JKRUg4nS0Cvt7c3qIu6DLF1cVLgwEDeN5yJ7v4rim3y0vCCaD2wkiFQVBz2cr4ibfiZLzQA5PTyU2yO1g/OIPNu//0c7qkYnRhk=
  # AZURE_WA_PASSWORD
  - secure: onaQkKScuNE6VrORV+rutfscHZGqMJqSrJJzKGTej/YnNS55mZUUNQA3WdlaOsTkUInWEcIqa9APGOWoONoTTOtzHIw82kHxkazKZnYd1cJoPHiWZgFNNMxHfsSvHunyhszOa5C+zHdGE1telyi2VhHDeSLbc0JbCkyiwGMXnb3pi9Pu9ZgcIFEt72XE0g7m88DZaFIH8DFoeVpSTDXOMosNZayntYxeyeR5DM8uXqQ4dVmF4e2ku14P5QA1V2jrNqLzio9SsWgnWUrMJvoekaAA4oPY9Hie/VIW0EB48B6owVVye9T+c+DaPkI9zm3q/74fa3Hb9yj9qqgmZTgF1k6qg4HrT8WCKOtccW9pP7uOY0spzo015FfO0+qI7VbP5DQk8xMMdkevx+VBFz6+dmZHaptnXkv335Jx79Al7PYTtVBmOfqk1zO24Wnt7cV1hXPGjHI2mAAccSNY5bitoQbxjK8HF8IGQ70a7zS2gV9gQJE13Xo0OcCw81Xobhe2AOMwX1YMzTcv+nFh9gYPwKijQyuHAccUItm6GBXm1cL49ZBmagEG1UHePG+02bAAfxTXKTl5XZJLq6ofMs6r47UhcgMGfo4oGiLYMqxjJH9smuVEP+8FK8nzRBPYgUhJtedvzOjqI2hC424x/SMUUN3qGRErzY2vgPuZegesQvE=
before_script:
- psql -c 'create database travis_ci_test;' -U postgres
script:
- "./travis-build.sh --quiet verify"
deploy:
- provider: script
  skip_cleanup: true
  script: chmod +x ./travis-nuget-deploy.sh && ./travis-nuget-deploy.sh $NUGET_API_KEY $NUGET_SOURCE
  on:
    all_branches: true
- provider: azure_web_apps
  username: govuk-dfe-bat-deployment-user
  site: bat-dev-manage-courses-api-app	
  on: master	   
- provider: azure_web_apps
  username: govuk-dfe-bat-deployment-user
  site: bat-staging-manage-courses-api-app	
  on: staging	   
- provider: azure_web_apps
  username: govuk-dfe-bat-deployment-user
  site: bat-prod-manage-courses-api-app	
  on: production
services:
- postgresql: '9.6'
